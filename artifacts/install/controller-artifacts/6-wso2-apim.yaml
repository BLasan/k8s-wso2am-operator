apiVersion: apim.wso2.com/v1alpha1
kind: APIManager
metadata:
  name: cluster-1
  namespace: test
spec:
  pattern: Pattern-1
  service:
    type: NodePort
  profiles:
    #configurations for apim instance 1
    - name: api-manager-1
#      deployment:
#        replicas: 1
#        minReadySeconds: 240
#        imagePullPolicy: Always
#        resources:
#          requests:
#            memory: 2Gi
#            cpu: 2000m
#          limits:
#            memory: 3Gi
#            cpu: 3000m
#        livenessProbe:
#          initialDelaySeconds: 240
#          failureThreshold: 3
#          periodSeconds: 10
#        readinessProbe:
#          initialDelaySeconds: 240
#          failureThreshold: 3
#          periodSeconds: 10
#        configMaps:
#          deploymentConfigMap: wso2am-pattern-1-am-1-conf
#          newConfigMap:
#            - name: custom-sequence-in-cm
#              mountPath: /home/wso2carbon/wso2am-3.0.0-config/repository/resources/custom-sequences/in
#            - name: custom-sequence-out-cm
#              mountPath: /home/wso2carbon/wso2am-3.0.0-config/repository/resources/custom-sequences/
#        persistentVolumeClaim:
#          synapseConfigs: custom-synapse-config
#          executionPlans: custom-execution-plan
#          newClaim:
#            - name: new-pvc-claim-1
#              mountPath: /home/wso2carbon/wso2-artifact-volume/repository/deployment/server/vol1
#            - name: new-pvc-claim-2
#              mountPath: /home/wso2carbon/wso2-artifact-volume/repository/deployment/server/vol2
    #configurations for apim instance 2
    - name: api-manager-2
      service:
        type: NodePort
      deployment:
        resources:
          requests:
            memory: 2Gi
            cpu: 2000m
          limits:
            memory: 3Gi
            cpu: 3000m
        replicas: 1
        minReadySeconds: 240
        imagePullPolicy: Always
        livenessProbe:
          initialDelaySeconds: 240
          failureThreshold: 3
          periodSeconds: 10
        readinessProbe:
          initialDelaySeconds: 240
          failureThreshold: 3
          periodSeconds: 10



    #configurations for analytics dashboard
    - name: analytics-dashboard
      service:
        type: NodePort
      deployment:
        resources:
          requests:
            memory: 4Gi
            cpu: 2000m
          limits:
            memory: 4Gi
            cpu: 2000m
        replicas: 1
        minReadySeconds: 30
        imagePullPolicy: Always
        livenessProbe:
          initialDelaySeconds: 20
          failureThreshold: 3
          periodSeconds: 10
        readinessProbe:
          initialDelaySeconds: 20
          failureThreshold: 3
          periodSeconds: 10
    #configurations for analytics worker
    - name: analytics-worker
      service:
        type: NodePort
      deployment:
        resources:
          requests:
            memory: 4Gi
            cpu: 2000m
          limits:
            memory: 4Gi
            cpu: 2000m
        replicas: 1
        minReadySeconds: 30
        imagePullPolicy: Always
        livenessProbe:
          initialDelaySeconds: 20
          failureThreshold: 3
          periodSeconds: 10
        readinessProbe:
          initialDelaySeconds: 20
          failureThreshold: 3
          periodSeconds: 10
